# Setup with Kind

Kind allows to properly run the webhooks.

```bash
kind create cluster --config hack/kind-config.yaml
```

## Dependencies

### Namespace

```bash
kubectl create ns workbench-operator-system
```

### Ingress-nginx

See: <https://kubernetes.github.io/ingress-nginx/deploy/>

```bash
helm upgrade --install ingress-nginx ingress-nginx \
             --repo https://kubernetes.github.io/ingress-nginx \
             --namespace ingress-nginx --create-namespace
```

### Cert-manager

See: <https://cert-manager.io/docs/installation/>

```bash
kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.16.1/cert-manager.yaml
```

Create the issuer and certificate that will be used by the webhook.

```bash
kubectl apply -k config/cert-manager
```

## Build and run

Build and load into Kind the controller.

```bash
docker buildx build -t registry.local/controller:v1
```

If you're using *kind*, load the image into it.

```
kind load docker-image registry.local/controller:v1
```
